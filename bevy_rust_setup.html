<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-10-12 Thu 20:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org0bdb033">1. How to setup bevy for web based game ?</a>
<ul>
<li><a href="#orgd2480cc">1.1. Prerequisites</a></li>
<li><a href="#org361e0c0">1.2. Creating a Bevy Project</a></li>
<li><a href="#org64a20a4">1.3. Writing Some Code</a></li>
<li><a href="#orgadb52ac">1.4. Building and Running the Game</a></li>
<li><a href="#org98c122e">1.5. Result</a>
<ul>
<li><a href="#orgf732147">1.5.1. <span class="todo TODO">TODO</span> ADD the image of the project (the cloud hosted image should be ready)</a></li>
</ul>
</li>
<li><a href="#org480ec2f">1.6. Deploying the Game</a></li>
<li><a href="#org514b4a5">1.7. Conclusion</a></li>
<li><a href="#orgad861fe">1.8. References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org0bdb033" class="outline-2">
<h2 id="org0bdb033"><span class="section-number-2">1.</span> How to setup bevy for web based game ?</h2>
<div class="outline-text-2" id="text-1">
<p>
Bevy is a fast and flexible game engine written in Rust that supports both native and web platforms. In this article, we will show you how to setup Bevy with Trunk, a tool that simplifies the development and deployment of web applications using WebAssembly.
</p>
</div>
<div id="outline-container-orgd2480cc" class="outline-3">
<h3 id="orgd2480cc"><span class="section-number-3">1.1.</span> Prerequisites</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Before we start, we need to install some tools and dependencies:
</p>

<ul class="org-ul">
<li>Rust: You can install Rust using rustup, the official Rust toolchain manager.</li>

<li>wasm32-unknown-unknown target: This is the target for compiling Rust code to WebAssembly. You can add it with <code>rustup target add wasm32-unknown-unknown</code>.</li>

<li>Trunk: This is a tool that helps us build, serve, and deploy web applications using WebAssembly. You can install it with <code>cargo install --locked trunk</code>.</li>
</ul>
</div>
</div>
<div id="outline-container-org361e0c0" class="outline-3">
<h3 id="org361e0c0"><span class="section-number-3">1.2.</span> Creating a Bevy Project</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Next, we need to create a new Bevy project using Cargo, the Rust package manager. We can use the following command:
</p>

<p>
<code>cargo new bevy_web_game</code>
</p>

<p>
This will create a new binary project called <code>bevy_web_game</code> in the current directory. We can then edit the <code>Cargo.toml</code> file to add our dependencies:
</p>

<div class="org-src-container">
<pre class="src src-toml">[package]
name = "speed_typing"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html
[dependencies]
bevy = "0.11"
</pre>
</div>

<p>
Here, we specify that we want to use Bevy version 0.11, which added out of the tools required for building a game (the full engine)
</p>
</div>
</div>
<div id="outline-container-org64a20a4" class="outline-3">
<h3 id="org64a20a4"><span class="section-number-3">1.3.</span> Writing Some Code</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Now that we have our project set up, we can write some code to load a simple asset in our Bevy project and run it. For this example, we will use an asset file that I downloaded on the internet. You should start by creating an <code>asset</code> folder at the root of your project (<code>bevy_web_game/asset</code>). You can copy and paste the code from there into your <code>src/main.rs</code> file, or write or your own logic.
</p>

<p>
Main function,
we set a title for our game, we attach our canvas to the object of the DOM that has the id <code>bevy</code>  (HTML corresponding canvas), we set the resolution of the window, and removing all the default event handling behavior of js.
</p>

<p>
<b>This syntax doesn't work for bevy 0.10 or older version, so make sure you use the last one 0.11</b>
</p>

<div class="org-src-container">
<pre class="src src-rust">use bevy::{prelude::*, window::PrimaryWindow};

fn main() {
    App::new()
	.insert_resource(Msaa::Off)
	.add_plugins(DefaultPlugins.set(
	    WindowPlugin {
		primary_window: Some(Window {
		    title: "Bevy Game".to_string(),
		    canvas: Some("#bevy".to_owned()),
		    resolution: (800., 600.).into(),
		    prevent_default_event_handling: false,
		    ..default()
		}),
		..default()
	    }))
	.add_systems(Startup, spawn_camera)
	.add_systems(Startup, spawn_test_sprite)
	.run();
}

</pre>
</div>

<p>
We create a component(Gojo) and a new system(spawn<sub>test</sub><sub>sprite</sub>) to spawn that component with his sprite on our game window. Refer to the <a href="https://docs.rs/bevy/latest/bevy/">Bevy's documentation</a>
</p>

<div class="org-src-container">
<pre class="src src-rust">#[derive(Component)]
pub struct Gojo;

pub fn spawn_test_sprite(
    mut commands: Commands,
    window_query: Query&lt;&amp;Window, With&lt;PrimaryWindow&gt;&gt;,
    asset_server: Res&lt;AssetServer&gt;
) {
    let window = window_query.get_single().unwrap();

    commands.spawn(
	(
	    SpriteBundle {
		transform: Transform::from_xyz(window.width() / 2.0, window.height() / 2.0, 0.0),
		texture: asset_server.load("tile.png"),
		..default()
	    },
	    Gojo {},
	));

}
</pre>
</div>

<p>
Creating a camera that will be spawn at the center of the screen. <b>The (0,0) point is located at the bottom left corner</b>.
</p>

<div class="org-src-container">
<pre class="src src-rust">pub fn spawn_camera(
    mut commands: Commands,
    window_query: Query&lt;&amp;Window, With&lt;PrimaryWindow&gt;&gt;,
) {

    let window = window_query.get_single().unwrap();

    commands.spawn(
	Camera2dBundle {
	    transform: Transform::from_xyz(window.width() / 2.0, window.height() / 2.0, 100.0),
	    ..default()
	}
    );
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgadb52ac" class="outline-3">
<h3 id="orgadb52ac"><span class="section-number-3">1.4.</span> Building and Running the Game</h3>
<div class="outline-text-3" id="text-1-4">
<p>
To build our game for the web, we need to use Trunk. Trunk provides a simple command line interface that automates the process of compiling our Rust code to WebAssembly, generating JavaScript bindings, bundling assets, and serving our application on a local server.
</p>

<p>
To able to use Trunk (that we've already installed), you will need to create an <code>index.html</code> file at the root of your project containing :
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;title&gt;Bevy game&lt;/title&gt;
    &lt;link data-trunk rel="copy-dir" href="assets" /&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class="game-container"&gt;
      &lt;canvas id="bevy"&gt; Javascript and support for canvas is required &lt;/canvas&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<p>
The <b>data-trunk</b> keyword is important for trunk to automatically download all your assets files in the final build.
As you can see we created a <code>canvas</code> with the id <code>bevy</code> corresponding to the one we put in the Rust main function.
</p>

<p>
To build our game, we can use the following command:
</p>

<p>
<code>trunk build</code>
</p>

<p>
This will create a dist folder in our project directory that contains all the files needed to run our game on the web.
</p>

<p>
To run our game locally, we can use the following command:
</p>

<p>
<code>trunk serve</code>
</p>

<p>
This will start a local server on port 8080 and open our game in a browser window. We can also access our game from any other device on the same network by visiting <a href="http://localhost:8080">http://localhost:8080</a>.
</p>

<p>
Trunk also supports live reloading, which means that any changes we make to our code or assets will be automatically reflected in our browser without refreshing.
</p>
</div>
</div>
<div id="outline-container-org98c122e" class="outline-3">
<h3 id="org98c122e"><span class="section-number-3">1.5.</span> Result</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-orgf732147" class="outline-4">
<h4 id="orgf732147"><span class="section-number-4">1.5.1.</span> <span class="todo TODO">TODO</span> ADD the image of the project (the cloud hosted image should be ready)</h4>
</div>
</div>
<div id="outline-container-org480ec2f" class="outline-3">
<h3 id="org480ec2f"><span class="section-number-3">1.6.</span> Deploying the Game</h3>
<div class="outline-text-3" id="text-1-6">
<p>
To deploy our game to the web, we need to host our dist folder on some server that supports static files. There are many options for this, such as GitHub Pages, Netlify, Firebase Hosting, etc.
</p>

<p>
For this example, we will use GitHub Pages as our hosting service. To do this, we need to create a new GitHub repository for our project and push our code there. Then, we need to enable GitHub Pages for our repository by going to Settings &gt; Pages and selecting the branch and folder where our dist folder is located.
</p>

<p>
After that, GitHub will generate a URL for our game that looks something like this: <a href="https://username.github.io/bevy_web_game/">https://username.github.io/bevy_web_game/</a>. We can then share this URL with anyone who wants to play our game on the web.
</p>
</div>
</div>
<div id="outline-container-org514b4a5" class="outline-3">
<h3 id="org514b4a5"><span class="section-number-3">1.7.</span> Conclusion</h3>
<div class="outline-text-3" id="text-1-7">
<p>
In this article, we have shown you how to setup Bevy with Trunk for web game programming. We have created a simple Bevy binary app and deployed it to the web using GitHub Pages. We hope this article has been helpful and inspiring for you to create your own web games using Bevy and Rust.
</p>
</div>
</div>
<div id="outline-container-orgad861fe" class="outline-3">
<h3 id="orgad861fe"><span class="section-number-3">1.8.</span> References</h3>
<div class="outline-text-3" id="text-1-8">
<p>
<a href="https://trunkrs.dev/#install">trunk doc</a>
</p>

<p>
<a href="https://www.youtube.com/watch?v=izhFutJiZgo&amp;list=PLVnntJRoP85JHGX7rGDu6LaF3fmDDbqyd&amp;index=2">Bevy Jacque's youtube playlist</a>
</p>

<p>
<a href="https://github.com/NiklasEi/bevy_game_template">Bevy game template</a>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2023-10-12 Thu 20:12</p>
</div>
</body>
</html>